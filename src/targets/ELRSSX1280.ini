# ********************************
# STM32L4 + SX1280 Transmitter Target
# ********************************

[env:ELRSSX1280TX_via_STLINK]
extends = env_common_stm32, radio_2400
board = l432kb
board_upload.maximum_size = 131072  ; Full flash available (128KB)
build_flags =
    ${env_common_stm32.build_flags}
    ${radio_2400.build_flags}
    ${common_env_data.build_flags_tx}
    -include target/ELRSSX1280TX.h
    -D HSI_VALUE=16000000U
    -D VECT_TAB_OFFSET=0x0U
    -D FLASH_APP_OFFSET=0x0U
    #-D DEBUG_LOG
    -Wl,--defsym=FLASH_APP_OFFSET=0
build_src_filter = ${env_common_stm32.build_src_filter} -<rx_*.cpp>
; No upload_flags â€“ direct flashing with ST-Link

; Upload via USB DFU (jumper disconnected, BOOT0 = 1)
[env:ELRSSX1280TX_via_DFU]
extends = env_common_stm32, radio_2400
board = l432kb
upload_protocol = dfu
upload_port = 0483:df11
build_flags =
    ${env_common_stm32.build_flags}
    ${radio_2400.build_flags}
    ${common_env_data.build_flags_tx}
    -include target/ELRSSX1280TX.h
    -D HSI_VALUE=16000000U
    -D VECT_TAB_OFFSET=0x8000U
    -D FLASH_APP_OFFSET=0x8000U
    -Wl,--defsym=FLASH_APP_OFFSET=0x8000
build_src_filter = ${env_common_stm32.build_src_filter} -<rx_*.cpp>             

